+++
date = "2016-04-07T09:55:49+08:00"
title = "python基础-字符串和编码"

tags = [ "python", "string"]
categories = [
  "python"
]

+++
<!--more-->

## 字符串

1. 字符串是以单引号`'`或双引号`"`括起来的任意文本，比如`'abc'`，`"xyz"` 
2. 如果字符串内部既包含`'`又包含`"`怎么办？可以用转义字符\来标识

        'I\'m \"OK\"!'

    表示的内容：

        I'm "OK"!

3. 转义字符\可以转义很多字符，比如`\n`表示换行，`\t`表示制表符，字符\本身也要转义，所以`\\`表示的字符就是\，

        >>> print('\\\t\\')
        \       \
        >>> print(r'\\\t\\')
        \\\t\\

4. 如果字符串内部有很多换行，用\n写在一行里不好阅读，为了简化，Python允许用`'''...'''`的格式表示多行内容


5. 多行字符串`'''...'''`还可以在前面加上r使用

## 编码

#### ASCII、Unicode和UTF-8的关系

1. 最早只有127个字母被编码到计算机里，也就是大小写英文字母、数字和一些符号，这个编码表被称为ASCII编码，比如大写字母A的编码是65，小写字母z的编码是122。
2. 处理中文显然一个字节是不够的，至少需要两个字节，而且还不能和ASCII编码冲突，所以，中国制定了GB2312编码，用来把中文编进去,日本把日文编到Shift_JIS里，韩国把韩文编到Euc-kr里,
各国有各国的标准，就会不可避免地出现冲突，结果就是，在多语言混合的文本中，显示出来会有乱码。
3. Unicode应运而生。Unicode把所有语言都统一到一套编码里，这样就不会再有乱码问题了。
4. ASCII编码和Unicode编码的区别：ASCII编码是1个字节，而Unicode编码通常是2个字节。
    字母A用ASCII编码是十进制的65，二进制的01000001；

    字符0用ASCII编码是十进制的48，二进制的00110000，注意字符'0'和整数0是不同的；

    汉字中已经超出了ASCII编码的范围，用Unicode编码是十进制的20013，二进制的01001110 00101101。
5. 如果统一成Unicode编码，乱码问题从此消失了。但是，如果你写的文本基本上全部是英文的话，用Unicode编码比ASCII编码需要多一倍的存储空间，在存储和传输上就十分不划算。
6. Unicode编码转化为“可变长编码”的UTF-8编码。
    UTF-8编码把一个Unicode字符根据不同的数字大小编码成1-6个字节，常用的英文字母被编码成1个字节，汉字通常是3个字节，只有很生僻的字符才会被编码成4-6个字节。
    如果你要传输的文本包含大量英文字符，用UTF-8编码就能节省空间
7. UTF-8编码有一个额外的好处，就是ASCII编码实际上可以被看成是UTF-8编码的一部分，所以，大量只支持ASCII编码的历史遗留软件可以在UTF-8编码下继续工作。

#### 计算机系统通用的字符编码工作方式
1. 在计算机内存中，统一使用Unicode编码，当需要保存到硬盘或者需要传输的时候，就转换为UTF-8编码。
2. 用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到内存里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件
3. 浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器

## python字符串(python2.7)

1. Python只支持ASCII编码
2. Python在后来添加了对Unicode的支持，以Unicode表示的字符串用u'...'表示

        >>> print u'中文'
        中文
        >>> u'中'
        u'\u4e2d

3. 字符串'xxx'虽然是ASCII编码，但也可以看成是UTF-8编码，而u'xxx'则只能是Unicode编码。

4. 把u'xxx'转换为UTF-8编码的'xxx'用encode('utf-8')方法

        >>> u'ABC'.encode('utf-8')
        'ABC'
        >>> u'中文'.encode('utf-8')
        '\xe4\xb8\xad\xe6\x96\x87'
    由unicode转化为指定的编码用encode。由指定编码 解码为 unicode 用decode

5. 英文字符转换后表示的UTF-8的值和Unicode值相等（但占用的存储空间不同），而中文字符转换后1个Unicode字符将变为3个UTF-8字符，\xe4就是其中一个字节，因为它的值是228，没有对应的字母可以显示，所以以十六进制显示字节的数值。len()函数可以返回字符串的长度

6. 由于Python源代码也是一个文本文件，所以，当你的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为UTF-8编码。当Python解释器读取源代码时，为了让它按UTF-8编码读取，我们通常在文件开头写上这两行

        #!/usr/bin/env python
        # -*- coding: utf-8 -*-

    第一行注释是为了告诉Linux/OS X系统，这是一个Python可执行程序，Windows系统会忽略这个注释；

    第二行注释是为了告诉Python解释器，按照UTF-8编码读取源代码，否则，你在源代码中写的中文输出可能会有乱码。

7. python3字符串是以Unicode编码的

## 格式化

1. 采用的格式化方式和C语言是一致的，用%实现
2. 有几个%?占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个%?，括号可以省略。
3. 常见的占位符有：

    %d  整数 
    %f  浮点数 
    %s  字符串 
    %x  十六进制整数 
4. 格式化整数和浮点数还可以指定是否补0和整数与小数的位数

        >>> '%2d-%02d' % (3, 1)
        ' 3-01'
        >>> '%.2f' % 3.1415926
        '3.14'

5. 如果你不太确定应该用什么，%s永远起作用，它会把任何数据类型转换为字符串
6. 对于Unicode字符串，用法完全一样，但最好确保替换的字符串也是Unicode字符串

        >>> u'Hi, %s' % u'Michael'
        u'Hi, Michael'

7. 字符串里面的%是一个普通字符的时候就需要转义，用%%来表示一个%

        >>> 'growth rate: %d %%' % 7
        'growth rate: 7 %'

8. Python当然也支持其他编码方式，比如把Unicode编码成GB2312

        >>> u'中文'.encode('gb2312')
        '\xd6\xd0\xce\xc4'

    如果没有特殊业务要求，请牢记仅使用Unicode和UTF-8这两种编码方式

9. 在Python 3.x版本中，把'xxx'和u'xxx'统一成Unicode编码，即写不写前缀u都是一样的

    由于Python3.x的字符串类型是str，在内存中以Unicode表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把str变为以字节为单位的bytes。

    Python3.x对bytes类型的数据用带b前缀的单引号或双引号表示：b'xxx'
